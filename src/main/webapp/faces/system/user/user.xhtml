<ui:composition 
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	template="/layout/avalon/template.xhtml">

	<ui:define name="content">
		<h:form id="insertEditForm">
			<p:dialog widgetVar="dlgInfor" header="#{msg['label.title_detail']}" id="dlgInfor" showEffect="clip" hideEffect="drop" height="90%" width="80%">
				<p:ajax event="close" >
					<p:resetInput target=":insertEditForm" />
				</p:ajax>
				
				<ui:remove>
				<p:growl id="mainMessage" showDetail="true" sticky="true" life="5000" />
				</ui:remove>
				<p:panel id="pnlInfo">
				    <div class="ui-g">
				    	<div class="ui-g-12">
				    		<p:messages id="mainMessage" showSummary="false" showDetail="true" autoUpdate="true" closable="true" />
				    	</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.username']}" /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:inputText id="username" styleClass="w80pc" 
								 required="true" label="#{msg['label.username']}" 
								 value="#{scUserController.newObj.username}" validator="form.SpecialCharacterValidator" />
							<p:watermark for="username" value="#{msg['label.username']}" />
						</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.password']}" /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:password id="password" styleClass="w80pc"
								required="#{!scUserController.isEdit}" label="#{msg['label.password']}"
								 value="#{scUserController.newObj.password}" validator="form.PasswordValidator" />
							<p:watermark for="password" value="#{msg['label.password']}" />
						</div>
						
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.firstName']} " /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:inputText id="firstName" styleClass="w80pc"
								required="true" label="#{msg['label.firstName']} "
								 value="#{scUserController.newObj.firstName}" validator="form.SpecialCharacterValidator" />
							<p:watermark for="firstName" value="#{msg['label.firstName']} " />
						</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.lastName']} " /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:inputText id="lastName" styleClass="w80pc"
								required="true" label="#{msg['label.lastName']}"	 
								value="#{scUserController.newObj.lastName}" validator="form.SpecialCharacterValidator" />
							<p:watermark for="lastName" value="#{msg['label.lastName']} " />
						</div>
						
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.email']} " /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:inputText id="email" styleClass="w80pc"
								required="true" label="#{msg['label.email']}"
								 value="#{scUserController.newObj.email}" validator="form.EmailValidator" />
							<p:watermark for="email" value="#{msg['label.email']} " />
						</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.mobile']} " /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:inputText id="mobile" styleClass="w80pc"
								required="true" label="#{msg['label.mobile']}"
									 value="#{scUserController.newObj.mobile}" validator="form.NumberValidator" />
							<p:watermark for="mobile" value="#{msg['label.mobile']} " />
						</div>
	
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.address']} " /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:inputText id="address" styleClass="w80pc"
								required="true" label="#{msg['label.address']}"
								 value="#{scUserController.newObj.address}" validator="form.SpecialCharacterValidator" />
							<p:watermark for="address" value="#{msg['label.address']} " />
						</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.birthday']} " /><span class="required">*</span>
						</div>
						<div class="ui-g-4">
							<p:calendar id="birthday" styleClass="w80pc" 
								required="true" label="#{msg['label.birthday']}"
								value="#{scUserController.newObj.birthday}" pattern="dd/MM/yyyy"/>
							<p:watermark for="birthday" value="#{msg['label.birthday']} " />
						</div>
	
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.status']} " />
						</div>
						<div class="ui-g-4">
							<p:selectOneMenu id="status" label="#{msg['label.status']} " styleClass="w80pc" value="#{scUserController.newObj.status}">
					            <f:selectItem itemLabel="#{msg['label.status_active']} " itemValue="1" />
					            <f:selectItem itemLabel="#{msg['label.status_lock']}" itemValue="0" />
					            <f:selectItem itemLabel="#{msg['label.status_not_active']}" itemValue="3" />
					        </p:selectOneMenu>
						</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.gender']} " />
						</div>
						<div class="ui-g-4">
							 <p:selectOneMenu id="gender" label="#{msg['label.gender']}" styleClass="w80pc" value="#{scUserController.newObj.gender}">
					            <f:selectItem itemLabel="#{msg['label.gender_male']}" itemValue="1" />
					            <f:selectItem itemLabel="#{msg['label.gender_female']}" itemValue="2" />
					        </p:selectOneMenu>
						</div>
						
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.type']} " />
						</div>
						<div class="ui-g-4">
							<p:selectOneMenu id="type" label="#{msg['label.type']}" styleClass="w80pc" value="#{scUserController.newObj.type}">
					            <f:selectItem itemLabel="Loại 1" itemValue="1" />
					            <f:selectItem itemLabel="Loại 2" itemValue="2" />
					        </p:selectOneMenu>
						</div>
						<div class="ui-g-2">
							<h:outputText value="#{msg['label.note']} " />
						</div>
						<div class="ui-g-4">
							<p:inputText id="note" label="#{msg['label.note']}" styleClass="w80pc" 
								 value="#{scUserController.newObj.note}" validator="form.SpecialCharacterValidator" />
							<p:watermark for="note" value="#{msg['label.note']} " />
						</div>
						
						
					</div>
					<div class="ui-g">
						<div class="ui-g-10">
						</div>
						<div class="ui-g-2">
							<p:commandButton value="#{msg['btn.update']}"
								action="#{scUserController.saveOrUpdate}"
								oncomplete="PF('blockUiSearch').hide()"		
								onstart="PF('blockUiSearch').show()"					
								update=":insertEditForm:pnlInfo, :insertEditForm:mainMessage">
							</p:commandButton>
							<p:commandButton value="#{msg['btn.close']}" process="@this"
								onclick="PF('dlgInfor').hide()">
							</p:commandButton>
						</div>
					</div>
				</p:panel>
			</p:dialog>
		</h:form>
		
		<h:form id="search">
			<div class="messagebox tc">		 
				<ui:remove>
				<p:growl id="designGrowl" showDetail="true" showSummary="true"
					life="30000" />
				</ui:remove>
				<p:growl id="searchMessage" showDetail="true" sticky="true"
					life="30000" />
			</div>
			<p:panel id="panel" header="#{msg['btn.search']}" toggleable="true" >
				<div class="ui-g">
					<div class="ui-g-2">
						<h:outputText value="#{msg['label.username']} " />
					</div>
					<div class="ui-g-4">
						<p:inputText id="username" styleClass="w80pc"
							 value="#{scUserController.searchObj.username}" >
						</p:inputText>
						<p:watermark for="username" value="#{msg['label.username']}" />
					</div>
					<div class="ui-g-2">
						<h:outputText value="#{msg['label.firstName']} " />
					</div>
					<div class="ui-g-4">
						<p:inputText id="firstName" styleClass="w80pc"
							 value="#{scUserController.searchObj.firstName}" >
						</p:inputText>						
						<p:watermark for="firstName" value="#{msg['label.firstName']} " />
					</div>
					<div class="ui-g-2">
						<h:outputText value="#{msg['label.lastName']} " />
					</div>
					<div class="ui-g-4">
						<p:inputText id="lastName" styleClass="w80pc"
							value="#{scUserController.searchObj.lastName}" >
						</p:inputText>
						<p:watermark for="lastName" value="#{msg['label.lastName']} " />
					</div>
					
					<div class="ui-g-2">
						<h:outputText value="#{msg['label.email']} " />
					</div>
					<div class="ui-g-4">
						<p:inputText id="email" styleClass="w80pc"
							 value="#{scUserController.searchObj.email}" >
						</p:inputText>
						<p:watermark for="email" value="#{msg['label.email']} " />
					</div>
					<div class="ui-g-2">
						<h:outputText value="#{msg['label.status']} " />
					</div>
					<div class="ui-g-4">
						<p:selectOneMenu id="status" styleClass="w80pc" value="#{scUserController.searchObj.status}">
							<f:selectItem itemLabel="#{msg['label.choose']}" itemValue="-1" />
				            <f:selectItem itemLabel="#{msg['label.status_active']}" itemValue="1" />
				            <f:selectItem itemLabel="#{msg['label.status_lock']}" itemValue="0" />
				            <f:selectItem itemLabel="#{msg['label.status_not_active']}" itemValue="3" />
				        </p:selectOneMenu>
					</div>
				</div>
					
				<div class="button-area fa" align="left">
					<h:panelGrid columns="3">
						<p:commandButton value="#{msg['btn.add_new']}"
							action="#{scUserController.clear}"  update=":insertEditForm, :insertEditForm:dlgInfor, :insertEditForm:mainMessage"
							oncomplete="PF('dlgInfor').show()">
							<p:resetInput target=":insertEditForm" />
						</p:commandButton>
							
						<p:commandButton value="#{msg['btn.search']}"
							update=":insertEditForm:mainMessage, :form, :form:objectTable"
							actionListener="#{scUserController.search}" 
							onstart="PF('blockUiSearch').show()" 
							oncomplete="PF('blockUiSearch').hide()"
							/>
					</h:panelGrid>
				</div>
			</p:panel>
		</h:form>

		<div class="cl h6"></div>
		<h:form id="form">
			<!-- <pe:blockUI target=":form:objectTable" content="blockUIContent" widgetVar="blockUiSearch" />						
			<h:panelGrid id="blockUIContent" style="display:none;" styleClass="blockUi">
				<h:graphicImage library="avalon-layout/images" name="ajaxloadingbar.gif" style="margin-right: 12px; vertical-align: middle;" />
			</h:panelGrid> -->
			<p:dataTable var="obj" value="#{scUserController.lazyDataModel}"
						 paginator="true" rows="25" filterEvent="keyup" rowKey="#{obj.id}"
						 rowIndexVar="rowIndex" paginatorPosition="bottom" id="objectTable"
						 widgetVar="objectTable" rowsPerPageTemplate="25, 50, 100"
						 lazy="true"  emptyMessage="#{msg['label.no_data']}"
						 editable="true" editMode="cell" >

				<p:ajax event="page" onstart="PF('blockUiSearch').show()" oncomplete="PF('blockUiSearch').hide()" />
				<p:ajax event="sort" onstart="PF('blockUiSearch').show()" oncomplete="PF('blockUiSearch').hide()" />

				<p:column style="width: 3%; text-align: center;" headerText="#{msg['label.stt']}">
					<h:outputText value="#{rowIndex+ 1}" />
				</p:column>

				<p:column width="15%" headerText="#{msg['label.username']}">
					<h:outputText value="#{obj.username}" />
				</p:column>
				<p:column width="10%" headerText="#{msg['label.lastName']}">
					<h:outputText value="#{obj.lastName}" />
				</p:column>
				<p:column width="10%" headerText="#{msg['label.firstName']}">
					<h:outputText value="#{obj.firstName}" />
				</p:column>
				<p:column width="15%" headerText="#{msg['label.email']}">
					<h:outputText value="#{obj.email}" />
				</p:column>
				<p:column width="10%" headerText="#{msg['label.status']} " style="text-align:center" >
					<h:outputText rendered="#{obj.status == 1}" value="#{msg['label.status_active']}"/>
					<h:outputText rendered="#{obj.status == 0}" value="#{msg['label.status_lock']}" style="color:red"/>
					<h:outputText rendered="#{obj.status == 3}" value="#{msg['label.status_not_active']}"/>
				</p:column>
				<p:column width="10%" headerText="#{msg['label.create_date']}" style="text-align:center" >
					<h:outputText value="#{obj.createDate}" >
						<f:convertDateTime pattern="dd/MM/yyyy"/>
					</h:outputText>
				</p:column>
				<p:column width="10%" headerText="#{msg['label.last_login']}" style="text-align:center" >
					<h:outputText value="#{obj.lastLogin}" >
						<f:convertDateTime pattern="dd/MM/yyyy HH:mm"/>
					</h:outputText>
				</p:column>
				<p:column style="width: 3%; text-align: center;" headerText="#{msg['btn.edit']}">
					<p:commandLink id="cmdEdit"
						action="#{scUserController.prepareEdit}" 
						update=":insertEditForm"
						oncomplete="PF('dlgInfor').show()">
						<p:resetInput target=":insertEditForm" />
						<f:setPropertyActionListener target="#{scUserController.selectedObj}" value="#{obj}" />
						<p:graphicImage value="/resources/images/icon/edit.png" width="15"	height="18" title="#{msg['btn.edit']}" />
					</p:commandLink>
				</p:column>

				<p:column style="width: 3%; text-align: center;" headerText="#{msg['btn.delete']}">
					<p:commandLink id="cmdDelete" actionListener="#{scUserController.delete(obj)}"
						onstart="PF('blockUiSearch').show()" oncomplete="PF('blockUiSearch').hide()"
					 	update=":search:searchMessage,:form, :form:objectTable">
						<f:setPropertyActionListener
							target="#{scUserController.selectedObj}" value="#{obj}" />
						<p:graphicImage value="/resources/images/icon/trash.png"
							width="15" height="18" title="#{msg['btn.delete']}" />
						<p:confirm header="#{msg['label.confirm']}" message="#{msg['label.are_you_sure']}" icon="ui-icon-alert" />
					</p:commandLink>
				</p:column>
			</p:dataTable>

			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
		        <p:commandButton value="#{msg['btn.yes']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />			        	 
		        <p:commandButton value="#{msg['btn.no']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			 </p:confirmDialog>
		</h:form>
		<script type="text/javascript">

		</script>
		<style>
			.blockUi tbody td {
				border-color: white !important;
			}
		</style>
	</ui:define>
</ui:composition>